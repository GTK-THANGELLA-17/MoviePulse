<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoviePulse Poll</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }
        .loading {
            position: fixed;
            width: 100%;
            height: 100%;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .loading h1 {
            font-size: 3rem;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 0.2; }
            50% { opacity: 1; }
            100% { opacity: 0.2; }
        }
        .about {
            margin: 2rem 0;
            text-align: center;
        }
        .form-section {
            padding: 2rem;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }
        .form-section h2 {
            margin-bottom: 1.5rem;
        }
        .btn-submit {
            display: block;
            width: 100%;
            padding: 0.75rem;
            font-size: 1.2rem;
            transition: background-color 0.3s ease;
        }
        .btn-submit:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <!-- Loading Page -->
    <div class="loading" id="loading">
        <h1>Loading...</h1>
    </div>
  <!-- Header -->
    <header class="bg-dark text-white text-center py-3">
        <h1 class="animated-title">Movie Pulse</h1>
    </header>
    <!-- Main Content -->
    <div class="container">
        <div class="about">
            <h1>Movie Pulse Poll <i class="fas fa-poll"></i></h1>
            <p>Share your preferences and help filmmakers understand audience interests worldwide.</p>
        </div>
        <div class="form-section">
            <h2><i class="fas fa-film"></i> Select Your Preferences</h2>
            <form id="pollForm">
                <div class="mb-3">
                    <label for="country" class="form-label">Country</label>
                    <select class="form-select" id="country" required>
                        <option value="" disabled selected>Select your country</option>
                        <option value="USA">USA</option>
                        <option value="India">India</option>
                        <option value="UK">UK</option>
                        <option value="Canada">Canada</option>
                        <!-- Add more countries as needed -->
                    </select>
                </div>
                <div class="mb-3">
                    <label for="filmIndustry" class="form-label">Film Industry</label>
                    <select class="form-select" id="filmIndustry" required disabled>
                        <option value="" disabled selected>Select film industry</option>
                        <option value="Hollywood">Hollywood</option>
                        <option value="Bollywood">Bollywood</option>
                        <option value="Tollywood">Tollywood</option>
                        <!-- Add more film industries as needed -->
                    </select>
                </div>
                <div class="mb-3">
                    <label for="genre" class="form-label">Favorite Genre</label>
                    <select class="form-select" id="genre" required disabled>
                        <option value="" disabled selected>Select genre</option>
                        <option value="Romantic">Romantic</option>
                        <option value="Mass">Mass</option>
                        <option value="Drama">Drama</option>
                        <option value="Love">Love</option>
                        <option value="Suspense">Suspense</option>
                        <!-- Add more genres as needed -->
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-submit" disabled>Submit</button>
            </form>
        </div>
        <div class="text-center">
            <a href="stats.html" class="btn btn-info mt-3"><i class="fas fa-chart-bar"></i> View Genre Statistics</a>
 <a href="landing.html" class="btn btn-info mt-3"><i class="fas fa-chart-bar"></i> View Main Page</a>
        </div>
    </div>
<!-- Footer -->
    <footer class="bg-dark text-white text-center py-3">
        <p>Designed and built by G. Thangella</p>
    </footer>
    <script>
        // Loading page functionality
        document.addEventListener("DOMContentLoaded", function() {
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
            }, 2000);
        });

        // Form submission
        document.getElementById('pollForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const country = document.getElementById('country').value;
            const filmIndustry = document.getElementById('filmIndustry').value;
            const genre = document.getElementById('genre').value;

            // Check if the user already polled for this industry
            if (localStorage.getItem('pollData')) {
                const pollData = JSON.parse(localStorage.getItem('pollData'));
                const alreadyPolled = pollData.some(poll => poll.country === country && poll.filmIndustry === filmIndustry);
                if (alreadyPolled) {
                    alert('You have already polled for this industry in your country. Thank you!');
                    return;
                }
            }

            // Add poll to local storage
            const pollData = JSON.parse(localStorage.getItem('pollData')) || [];
            pollData.push({ country, filmIndustry, genre, timestamp: new Date().toISOString() });
            localStorage.setItem('pollData', JSON.stringify(pollData));

            alert('Thank you for your submission!');

            // Reset form
            this.reset();
            // Disable submit button after successful submission
            document.querySelector('.btn-submit').disabled = true;
        });

        // Country selection change event
        document.getElementById('country').addEventListener('change', function() {
            const selectedCountry = this.value;
            const filmIndustrySelect = document.getElementById('filmIndustry');
            const genreSelect = document.getElementById('genre');
            const submitBtn = document.querySelector('.btn-submit');

            // Reset selections and enable options
            filmIndustrySelect.value = '';
            genreSelect.value = '';
            filmIndustrySelect.removeAttribute('disabled');
            genreSelect.removeAttribute('disabled');
            filmIndustrySelect.querySelectorAll('option').forEach(option => {
                option.disabled = true;
            });
            genreSelect.querySelectorAll('option').forEach(option => {
                option.disabled = true;
            });
            submitBtn.disabled = true;

            // Enable options based on selected country
            switch (selectedCountry) {
                case 'India':
                    filmIndustrySelect.querySelector('option[value="Bollywood"]').disabled = false;
                    filmIndustrySelect.querySelector('option[value="Tollywood"]').disabled = false;
                    genreSelect.querySelectorAll('option').forEach(option => {
                        option.disabled = false;
                    });
                    break;
                case 'USA':
                case 'UK':
                case 'Canada':
                    filmIndustrySelect.querySelector('option[value="Hollywood"]').disabled = false;
                    genreSelect.querySelectorAll('option').forEach(option => {
                        option.disabled = false;
                    });
                    break;
                default:
                    break;
            }
        });

        // Enable submit button when all required selections are made
        document.getElementById('pollForm').addEventListener('change', function() {
            const filmIndustry = document.getElementById('filmIndustry').value;
            const genre = document.getElementById('genre').value;
            const submitBtn = document.querySelector('.btn-submit');

            if (filmIndustry && genre) {
                submitBtn.disabled = false;
            } else {
                submitBtn.disabled = true;
            }
        });

        // Share data function
        function shareData() {
            const pollData = JSON.parse(localStorage.getItem('pollData')) || [];
            const sharedData = {};
            
            pollData.forEach(entry => {
                const key = `${entry.country} - ${entry.filmIndustry}`;
                if (!sharedData[key]) {
                    sharedData[key] = {};
                }
                if (!sharedData[key][entry.genre]) {
                    sharedData[key][entry.genre] = 0;
                }
                sharedData[key][entry.genre]++;
            });

            let shareText = 'Genre presence in Gmail:\n\n';
            Object.keys(sharedData).forEach(key => {
                const [country, industry] = key.split(' - ');
                shareText += `Country: ${country}\n`;
                shareText += `Industry: ${industry}\n`;
                shareText += `Date: ${new Date().toLocaleDateString()}\n`;
                shareText += `Time: ${new Date().toLocaleTimeString()}\n`;
                shareText += `Year: ${new Date().getFullYear()}\n`;
                shareText += `Month: ${new Date().toLocaleString('default', { month: 'long' })}\n\n`;

                Object.keys(sharedData[key]).forEach(genre => {
                    shareText += `${genre}: ${sharedData[key][genre]}\n`;
                });
                shareText += '\n';
            });

            // Example: sharing via console.log for demonstration
            console.log(shareText);
            // Replace with actual sharing method like Gmail's API or other integration
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
